import{P as U,az as se,aw as oe,r as _t,q as ae}from"./index.ec2996a9.js";import{i as he}from"./line.c272abf8.js";var le=["client","offset","scroll","bounds","margin"];function Ct(t){var e=[];return le.forEach(function(i){t[i]&&e.push(i)}),e}function Bt(t,e){var i={};if(e.indexOf("client")>-1&&(i.client={top:t.clientTop,left:t.clientLeft,width:t.clientWidth,height:t.clientHeight}),e.indexOf("offset")>-1&&(i.offset={top:t.offsetTop,left:t.offsetLeft,width:t.offsetWidth,height:t.offsetHeight}),e.indexOf("scroll")>-1&&(i.scroll={top:t.scrollTop,left:t.scrollLeft,width:t.scrollWidth,height:t.scrollHeight}),e.indexOf("bounds")>-1){var r=t.getBoundingClientRect();i.bounds={top:r.top,right:r.right,bottom:r.bottom,left:r.left,width:r.width,height:r.height}}if(e.indexOf("margin")>-1){var n=getComputedStyle(t);i.margin={top:n?parseInt(n.marginTop):0,right:n?parseInt(n.marginRight):0,bottom:n?parseInt(n.marginBottom):0,left:n?parseInt(n.marginLeft):0}}return i}function fe(t){var e=t&&t.ownerDocument&&t.ownerDocument.defaultView;return e||window}function ue(t){return function(e){var i,r;return r=i=function(n){se(s,n);function s(){for(var a,l=arguments.length,d=new Array(l),u=0;u<l;u++)d[u]=arguments[u];return a=n.call.apply(n,[this].concat(d))||this,a.state={contentRect:{entry:{},client:{},offset:{},scroll:{},bounds:{},margin:{}}},a._animationFrameID=null,a._resizeObserver=null,a._node=null,a._window=null,a.measure=function(c){var v=Bt(a._node,t||Ct(a.props));c&&(v.entry=c[0].contentRect),a._animationFrameID=a._window.requestAnimationFrame(function(){a._resizeObserver!==null&&(a.setState({contentRect:v}),typeof a.props.onResize=="function"&&a.props.onResize(v))})},a._handleRef=function(c){a._resizeObserver!==null&&a._node!==null&&a._resizeObserver.unobserve(a._node),a._node=c,a._window=fe(a._node);var v=a.props.innerRef;v&&(typeof v=="function"?v(a._node):v.current=a._node),a._resizeObserver!==null&&a._node!==null&&a._resizeObserver.observe(a._node)},a}var o=s.prototype;return o.componentDidMount=function(){this._resizeObserver=this._window!==null&&this._window.ResizeObserver?new this._window.ResizeObserver(this.measure):new he(this.measure),this._node!==null&&(this._resizeObserver.observe(this._node),typeof this.props.onResize=="function"&&this.props.onResize(Bt(this._node,t||Ct(this.props))))},o.componentWillUnmount=function(){this._window!==null&&this._window.cancelAnimationFrame(this._animationFrameID),this._resizeObserver!==null&&(this._resizeObserver.disconnect(),this._resizeObserver=null)},o.render=function(){var l=this.props;l.innerRef,l.onResize;var d=oe(l,["innerRef","onResize"]);return _t.exports.createElement(e,ae({},d,{measureRef:this._handleRef,measure:this.measure,contentRect:this.state.contentRect}))},s}(_t.exports.Component),i.propTypes={client:U.bool,offset:U.bool,scroll:U.bool,bounds:U.bool,margin:U.bool,innerRef:U.oneOfType([U.object,U.func]),onResize:U.func},r}}var qt=ue()(function(t){var e=t.measure,i=t.measureRef,r=t.contentRect,n=t.children;return n({measure:e,measureRef:i,contentRect:r})});qt.displayName="Measure";qt.propTypes.children=U.func;function Et(t){return t<0?-1:1}function Vt(t,e,i){var r=t._x1-t._x0,n=e-t._x1,s=(t._y1-t._y0)/(r||n<0&&-0),o=(i-t._y1)/(n||r<0&&-0),a=(s*n+o*r)/(r+n);return(Et(s)+Et(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function Mt(t,e){var i=t._x1-t._x0;return i?(3*(t._y1-t._y0)/i-e)/2:e}function lt(t,e,i){var r=t._x0,n=t._y0,s=t._x1,o=t._y1,a=(s-r)/3;t._context.bezierCurveTo(r+a,n+a*e,s-a,o-a*i,s,o)}function st(t){this._context=t}st.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:lt(this,this._t0,Mt(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var i=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,lt(this,Mt(this,i=Vt(this,t,e)),i);break;default:lt(this,this._t0,i=Vt(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=i}}};Object.create(st.prototype).point=function(t,e){st.prototype.point.call(this,e,t)};function gi(t){return new st(t)}class Ot{constructor(e){this.base=e}[Symbol.iterator](){return this.base[Symbol.iterator]()}concat(...e){return $(function*(i){for(const r of i)yield*r}([this,...e.map($)]))}entries(){return $(function*(e){let i=0;for(const r of e)yield[i++,r]}(this))}every(e){return!this.some((i,r)=>!e(i,r))}fill(e){return this.map(()=>e)}filter(e){return $(function*(i){for(const[r,n]of i)e(n,r)&&(yield n)}(this.entries()))}find(e){for(const[i,r]of this.entries())if(e(r,i))return r}findIndex(e){for(const[i,r]of this.entries())if(e(r,i))return i;return-1}flatMap(e){return $(function*(i){for(const[r,n]of i)yield*$(e(n,r))}(this.entries()))}forEach(e){for(const[i,r]of this.entries())e(r,i)}includes(e,i=0){return this.indexOf(e,i)>=0}indexOf(e,i=0){if(i<0)throw new Error("fromIndex doesn't support negative numbers because generator length isn't known");for(const[r,n]of this.entries())if(r>=i&&n===e)return r;return-1}join(e=","){return[...this].join(e)}keys(){return $(function*(e){let i=0;for(const r of e)yield i++}(this))}lastIndexOf(e,i=1/0){if(i<0)throw new Error("fromIndex doesn't support negative numbers because generator length isn't known");let r=-1;for(const[n,s]of this.entries())n<=i&&s===e&&(r=n);return r}get length(){return this.reduce(e=>e+1,0)}map(e){return $(function*(i){for(const[r,n]of i)yield e(n,r)}(this.entries()))}reduce(e,i){if(i===void 0){const r=e;let n=!0,s;for(const[o,a]of this.entries())n?(s=a,n=!1):s=r(s,a,o);if(n)throw new TypeError("Reduce of empty iterable with no initial value");return s}else{const r=e;let n=i;for(const[s,o]of this.entries())n=r(n,o,s);return n}}reverse(){return $([...this].reverse())}slice(e=0,i=1/0){return $(function*(r){for(const[n,s]of r)if(!(n<e))if(n<i)yield s;else break}(this.entries()))}some(e){for(const[i,r]of this.entries())if(e(r,i))return!0;return!1}sort(e){return $([...this].sort(e))}splice(e,i=0,...r){return $(function*(n){for(const[s,o]of n)s===e&&(yield*r),(s<e||s>=e+i)&&(yield o)}(this.entries()))}values(){return this}}function ce(t){return typeof t[Symbol.iterator]=="function"}function $(t){return ce(t)?new Ot(t):new Ot({[Symbol.iterator]:()=>t})}function Ut(t){if(t!==void 0)return t;throw new Error("got unexpected undefined value")}function Dt(t,e){e.size<t.size&&([e,t]=[t,e]);for(const i of t)if(e.has(i))return!0;return!1}class N extends Map{getThrow(e){const i=this.get(e);if(i===void 0)throw new Error(`map doesn't contain key: ${e}`);return i}getDefault(e,i){const r=this.get(e);return r===void 0?i:r}setIfAbsent(e,i){const r=this.get(e);return r===void 0?(this.set(e,i),i):r}}class it{constructor(e,i,r=[]){this.child=e,this.data=i,this.points=r}}class de{constructor(e,i,r,n){this.source=e,this.target=i,this.data=r,this.points=n}}class Wt{constructor(e,i){this.id=e,this.data=i,this.dataChildren=[]}iroots(){return $([this])}roots(){return[this]}*iterChildren(){for(const{child:e}of this.dataChildren)yield e}ichildren(){return $(this.iterChildren())}children(){return[...this.ichildren()]}*iterChildLinks(){for(const{child:e,data:i,points:r}of this.dataChildren)yield new de(this,e,i,r)}ichildLinks(){return $(this.iterChildLinks())}childLinks(){return[...this.ichildLinks()]}[Symbol.iterator](){return new P([this])[Symbol.iterator]()}idescendants(e="depth"){return new P([this]).idescendants(e)}descendants(e="depth"){return[...this.idescendants(e)]}ilinks(){return new P([this]).ilinks()}links(){return[...this.ilinks()]}size(){return new P([this]).size()}sum(e){return new P([this]).sum(e),this}count(){return new P([this]).count(),this}height(){return new P([this]).height(),this}depth(){return new P([this]).depth(),this}split(){return[this]}connected(){return!0}}class P{constructor(e){this.dagRoots=e}[Symbol.iterator](){return this.idepth()}iroots(){return $(this.dagRoots)}roots(){return this.dagRoots.slice()}*idepth(){const e=this.roots(),i=new Set;let r;for(;r=e.pop();)i.has(r.id)||(i.add(r.id),yield r,e.push(...r.ichildren()))}*ibreadth(){const e=new Set;let i=this.roots(),r=[];do{r=i.reverse(),i=[];let n;for(;n=r.pop();)e.has(n.id)||(e.add(n.id),yield n,i.push(...n.ichildren()))}while(i.length)}*ibefore(){const e=new N;for(const n of this)for(const s of n.ichildren())e.set(s.id,e.getDefault(s.id,0)+1);const i=this.roots();let r;for(;r=i.pop();){yield r;for(const n of r.ichildren()){const s=e.getThrow(n.id);s>1?e.set(n.id,s-1):i.push(n)}}}*iafter(){const e=this.roots(),i=new Set;let r;for(;r=e.pop();)i.has(r.id)||(r.ichildren().every(n=>i.has(n.id))?(i.add(r.id),yield r):(e.push(r),e.push(...r.ichildren())))}idescendants(e="depth"){if(e==="depth")return $(this.idepth());if(e==="breadth")return $(this.ibreadth());if(e==="before")return $(this.ibefore());if(e==="after")return $(this.iafter());throw new Error(`unknown iteration style: ${e}`)}descendants(e="depth"){return[...this.idescendants(e)]}ilinks(){return this.idescendants().flatMap(e=>e.ichildLinks())}links(){return[...this.ilinks()]}size(){return this.idescendants().reduce(e=>e+1,0)}sum(e){const i=new N;for(const[r,n]of this.idescendants("after").entries()){const s=e(n,r),o=new N;o.set(n.id,s);for(const a of n.ichildren()){const l=i.getThrow(a.id);for(const[d,u]of l.entries())o.set(d,u)}n.value=$(o.entries()).map(([,a])=>a).reduce((a,l)=>a+l),i.set(n.id,o)}return this}count(){const e=new N;for(const i of this.idescendants("after"))if(i.ichildren()[Symbol.iterator]().next().done)e.set(i.id,new Set([i.id])),i.value=1;else{const r=new Set;for(const n of i.ichildren()){const s=e.getThrow(n.id);for(const o of s)r.add(o)}e.set(i.id,r),i.value=r.size}return this}height(){for(const e of this.idescendants("after"))e.value=Math.max(0,...e.ichildren().map(i=>{if(i.value===void 0)throw new Error("`after` iteration didn't iterate in after order");return i.value+1}));return this}depth(){const e=new N;for(const i of this)for(const r of i.ichildren())e.setIfAbsent(r.id,[]).push(i);for(const i of this.idescendants("before"))i.value=Math.max(0,...e.getDefault(i.id,[]).map(r=>{if(r.value===void 0)throw new Error("`before` iteration didn't iterate in before order");return r.value+1}));return this}split(){const e=new N,i=new N;for(const s of this.iroots())e.set(s.id,[]),i.set(s.id,new Set(s.idescendants().map(o=>o.id)));for(const[s,o]of this.iroots().entries()){const a=i.getThrow(o.id);for(const l of this.iroots().slice(s+1)){const d=i.getThrow(l.id);Dt(a,d)&&(e.getThrow(o.id).push(l),e.getThrow(l.id).push(o))}}const r=[],n=new Set;for(const s of this.iroots())if(!n.has(s.id)){n.add(s.id);const o=[s];r.push(o);const a=e.getThrow(s.id).slice();let l;for(;l=a.pop();)n.has(l.id)||(n.add(l.id),o.push(l),a.push(...e.getThrow(l.id)))}return r.map(s=>s.length>1?new P(s):s[0])}connected(){return this.split().length===1}}function ve(t){if(typeof t!="string")throw new Error(`id is supposed to be string but got type ${typeof t}`);if(t.indexOf("\0")>=0)throw new Error(`node id ${t} contained null character`);return t}function pe(t){if(!t.length)throw new Error("dag contained no roots");const e=new Set,i=new Set;let r=null;function n(s){if(e.has(s.id))return[];if(i.has(s.id))return r=s.id,[s.id];{i.add(s.id);let o=[];for(const a of s.ichildren())if(o=n(a),o.length)break;return i.delete(s.id),e.add(s.id),o.length&&r!==null&&o.push(s.id),r===s.id&&(r=null),o}}for(const s of t){const o=n(s);if(o.length)throw new Error("dag contained a cycle: "+o.reverse().join(" -> "))}for(const s of new P(t))if(new Set(s.ichildren().map(a=>a.id)).size!==s.dataChildren.length)throw new Error(`node '${s.id}' contained duplicate children`)}function rt(t,e,i){function r(a){if(!a.length)throw new Error("can't stratify empty data");const l=a.map((c,v)=>new Wt(ve(t(c,v)),c)),d=new Map;l.forEach(c=>{if(d.has(c.id))throw new Error(`found a duplicate id: ${c.id}`);d.set(c.id,c)});const u=[];return l.forEach((c,v)=>{const p=i(c.data,v)||[];p.forEach(([m,f])=>{const b=d.get(m);if(!b)throw new Error(`missing id: ${m}`);return b.dataChildren.push(new it(c,f)),b}),p.length||u.push(c)}),pe(u),u.length>1?new P(u):u[0]}function n(a){return a===void 0?t:rt(a,e,i)}r.id=n;function s(a){return a===void 0?i:rt(t,be(a),a)}r.parentData=s;function o(a){return a===void 0?e:rt(t,a,Ht(a))}return r.parentIds=o,r}function Ht(t){function e(i,r){return(t(i,r)||[]).map(n=>[n,void 0])}return e.wrapped=t,e}function be(t){function e(i,r){return(t(i,r)||[]).map(([n])=>n)}return e.wrapped=t,e}function xe(t){try{return typeof t.id=="string"}catch{return!1}}function me(t){if(xe(t))return t.id;throw new Error(`default id function expected datum to have an id field but got: ${t}`)}function ye(t){try{const e=t.parentIds;return e===void 0||e instanceof Array&&e.every(i=>typeof i=="string")}catch{return!1}}function Rt(t){if(ye(t))return t.parentIds;throw new Error(`default parentIds function expected datum to have a parentIds field but got: ${t}`)}function wi(...t){if(t.length)throw Error(`got arguments to dagStratify(${t}), but constructor takes no aruguments. These were probably meant as data which should be called as dagStratify()(...)`);return rt(me,Rt,Ht(Rt))}let tt=1e-60,Tt,St;do tt+=tt,Tt=1+.1*tt,St=1+.2*tt;while(Tt<=1||St<=1);var ft=tt;function ge(t,e,i){let r,n;for(let s=1;s<=i;s+=1){t[s][s]=1/t[s][s],n=-t[s][s];for(let o=1;o<s;o+=1)t[o][s]*=n;if(r=s+1,i<r)break;for(let o=r;o<=i;o+=1){n=t[s][o],t[s][o]=0;for(let a=1;a<=s;a+=1)t[a][o]+=n*t[a][s]}}}var we=ge;function Ie(t,e,i,r){let n,s;for(n=1;n<=i;n+=1){s=0;for(let o=1;o<n;o+=1)s+=t[o][n]*r[o];r[n]=(r[n]-s)/t[n][n]}for(let o=1;o<=i;o+=1){n=i+1-o,r[n]/=t[n][n],s=-r[n];for(let a=1;a<n;a+=1)r[a]+=s*t[a][n]}}var _e=Ie;function Ce(t,e,i,r){let n,s,o;for(let a=1;a<=i;a+=1){if(r[1]=a,o=0,n=a-1,n<1){if(o=t[a][a]-o,o<=0)break;t[a][a]=Math.sqrt(o)}else{for(let l=1;l<=n;l+=1){s=t[l][a];for(let d=1;d<l;d+=1)s-=t[d][a]*t[d][l];s/=t[l][l],t[l][a]=s,o+=s*s}if(o=t[a][a]-o,o<=0)break;t[a][a]=Math.sqrt(o)}r[1]=0}}var Be=Ce;function Ee(t,e,i,r,n,s,o,a,l,d,u,c,v,p=0,m,f,b){let x,y,C,I,g,w,B,M,E,V,j,z,q,F;const H=Math.min(r,u);let T=2*r+H*(H+5)/2+2*u+1;for(let h=1;h<=r;h+=1)f[h]=e[h];for(let h=r+1;h<=T;h+=1)f[h]=0;for(let h=1;h<=u;h+=1)v[h]=0,s[h]=0;const k=[];if(b[1]===0){if(Be(t,i,r,k),k[1]!==0){b[1]=2;return}_e(t,i,r,e),we(t,i,r)}else{for(let h=1;h<=r;h+=1){n[h]=0;for(let _=1;_<=h;_+=1)n[h]+=t[_][h]*e[_]}for(let h=1;h<=r;h+=1){e[h]=0;for(let _=h;_<=r;_+=1)e[h]+=t[h][_]*n[_]}}o[1]=0;for(let h=1;h<=r;h+=1){n[h]=e[h],o[1]+=f[h]*n[h],f[h]=0;for(let _=h+1;_<=r;_+=1)t[_][h]=0}o[1]=-o[1]/2,b[1]=0;const A=r,L=A+r,S=L+H,J=S+H+1,G=J+H*(H+1)/2,ht=G+u;for(let h=1;h<=u;h+=1){w=0;for(let _=1;_<=r;_+=1)w+=a[_][h]*a[_][h];f[ht+h]=Math.sqrt(w)}I=p,m[1]=0,m[2]=0;function ee(){m[1]+=1,T=G;for(let h=1;h<=u;h+=1){T+=1,w=-l[h];for(let _=1;_<=r;_+=1)w+=a[_][h]*n[_];if(Math.abs(w)<ft&&(w=0),h>c)f[T]=w;else if(f[T]=-Math.abs(w),w>0){for(let _=1;_<=r;_+=1)a[_][h]=-a[_][h];l[h]=-l[h]}}for(let h=1;h<=I;h+=1)f[G+v[h]]=0;C=0,g=0;for(let h=1;h<=u;h+=1)f[G+h]<g*f[ht+h]&&(C=h,g=f[G+h]/f[ht+h]);if(C===0){for(let h=1;h<=I;h+=1)s[v[h]]=f[S+h];return 999}return 0}function ie(){for(let h=1;h<=r;h+=1){w=0;for(let _=1;_<=r;_+=1)w+=t[_][h]*a[_][C];f[h]=w}x=A;for(let h=1;h<=r;h+=1)f[x+h]=0;for(let h=I+1;h<=r;h+=1)for(let _=1;_<=r;_+=1)f[x+_]=f[x+_]+t[_][h]*f[h];z=!0;for(let h=I;h>=1;h-=1){w=f[h],T=J+h*(h+3)/2,x=T-h;for(let _=h+1;_<=I;_+=1)w-=f[T]*f[L+_],T+=_;w/=f[x],f[L+h]=w,!(v[h]<=c)&&(w<=0||(z=!1,y=h))}if(!z){B=f[S+y]/f[L+y];for(let h=1;h<=I;h+=1)v[h]<=c||f[L+h]<=0||(g=f[S+h]/f[L+h],g<B&&(B=g,y=h))}w=0;for(let h=A+1;h<=A+r;h+=1)w+=f[h]*f[h];if(Math.abs(w)<=ft){if(z)return b[1]=1,999;for(let h=1;h<=I;h+=1)f[S+h]=f[S+h]-B*f[L+h];return f[S+I+1]=f[S+I+1]+B,700}w=0;for(let h=1;h<=r;h+=1)w+=f[A+h]*a[h][C];M=-f[G+C]/w,q=!0,z||B<M&&(M=B,q=!1);for(let h=1;h<=r;h+=1)n[h]+=M*f[A+h],Math.abs(n[h])<ft&&(n[h]=0);o[1]+=M*w*(M/2+f[S+I+1]);for(let h=1;h<=I;h+=1)f[S+h]=f[S+h]-M*f[L+h];if(f[S+I+1]=f[S+I+1]+M,q){I+=1,v[I]=C,T=J+(I-1)*I/2+1;for(let h=1;h<=I-1;h+=1)f[T]=f[h],T+=1;if(I===r)f[T]=f[r];else{for(let h=r;h>=I+1;h-=1)if(f[h]!==0&&(E=Math.max(Math.abs(f[h-1]),Math.abs(f[h])),V=Math.min(Math.abs(f[h-1]),Math.abs(f[h])),f[h-1]>=0?g=Math.abs(E*Math.sqrt(1+V*V/(E*E))):g=-Math.abs(E*Math.sqrt(1+V*V/(E*E))),E=f[h-1]/g,V=f[h]/g,E!==1))if(E===0){f[h-1]=V*g;for(let _=1;_<=r;_+=1)g=t[_][h-1],t[_][h-1]=t[_][h],t[_][h]=g}else{f[h-1]=g,j=V/(1+E);for(let _=1;_<=r;_+=1)g=E*t[_][h-1]+V*t[_][h],t[_][h]=j*(t[_][h-1]+g)-t[_][h],t[_][h-1]=g}f[T]=f[I]}}else{w=-l[C];for(let h=1;h<=r;h+=1)w+=n[h]*a[h][C];if(C>c)f[G+C]=w;else if(f[G+C]=-Math.abs(w),w>0){for(let h=1;h<=r;h+=1)a[h][C]=-a[h][C];l[C]=-l[C]}return 700}return 0}function re(){if(T=J+y*(y+1)/2+1,x=T+y,f[x]===0||(E=Math.max(Math.abs(f[x-1]),Math.abs(f[x])),V=Math.min(Math.abs(f[x-1]),Math.abs(f[x])),f[x-1]>=0?g=Math.abs(E*Math.sqrt(1+V*V/(E*E))):g=-Math.abs(E*Math.sqrt(1+V*V/(E*E))),E=f[x-1]/g,V=f[x]/g,E===1))return 798;if(E===0){for(let h=y+1;h<=I;h+=1)g=f[x-1],f[x-1]=f[x],f[x]=g,x+=h;for(let h=1;h<=r;h+=1)g=t[h][y],t[h][y]=t[h][y+1],t[h][y+1]=g}else{j=V/(1+E);for(let h=y+1;h<=I;h+=1)g=E*f[x-1]+V*f[x],f[x]=j*(f[x-1]+g)-f[x],f[x-1]=g,x+=h;for(let h=1;h<=r;h+=1)g=E*t[h][y]+V*t[h][y+1],t[h][y+1]=j*(t[h][y]+g)-t[h][y+1],t[h][y]=g}return 0}function ne(){x=T-y;for(let h=1;h<=y;h+=1)f[x]=f[T],T+=1,x+=1;return f[S+y]=f[S+y+1],v[y]=v[y+1],y+=1,y<I?797:0}function It(){return f[S+I]=f[S+I+1],f[S+I+1]=0,v[I]=0,I-=1,m[2]+=1,0}for(F=0;;){if(F=ee(),F===999)return;for(;F=ie(),F!==0;){if(F===999)return;if(F===700)if(y===I)It();else{for(;re(),F=ne(),F===797;);It()}}}}var Ve=Ee;function Me(t,e,i,r=[],n=0,s=[0,0]){const o=[],a=[],l=[],d=[],u=[],c=[];let v="";const p=t.length-1,m=i[1].length-1;if(!r)for(let x=1;x<=m;x+=1)r[x]=0;if(p!==t[1].length-1&&(v="Dmat is not symmetric!"),p!==e.length-1&&(v="Dmat and dvec are incompatible!"),p!==i.length-1&&(v="Amat and dvec are incompatible!"),m!==r.length-1&&(v="Amat and bvec are incompatible!"),(n>m||n<0)&&(v="Value of meq is invalid!"),v!=="")return{message:v};for(let x=1;x<=m;x+=1)a[x]=0,d[x]=0;const f=0,b=Math.min(p,m);for(let x=1;x<=p;x+=1)l[x]=0;o[1]=0;for(let x=1;x<=2*p+b*(b+5)/2+2*m+1;x+=1)u[x]=0;for(let x=1;x<=2;x+=1)c[x]=0;return Ve(t,e,p,p,l,d,o,i,r,p,m,n,a,f,c,u,s),s[1]===1&&(v="constraints are inconsistent, no solution!"),s[1]===2&&(v="matrix D in quadratic function is not positive definite!"),{solution:l,Lagrangian:d,value:o,unconstrained_solution:e,iterations:c,iact:a,message:v}}var Oe=Me,Re={solveQP:Oe},Te=Re;function Se(t,e,i,r,n){if(!e.length)return[];const s=[[0]],o=[0],a=[[0]],l=[0];for(const c of t){const v=[0];v.push(...c),s.push(v)}o.push(...e),a.push(...e.map(()=>[0]));for(const c of i)for(const[v,p]of c.entries())a[v+1].push(-p);l.push(...r.map(c=>-c));const{solution:d,message:u}=Te.solveQP(s,o,a,l,n);if(u.length)throw new Error(`quadprog failed with: ${u}`);return d.shift(),d}function $e(t,e,i,r,n=0){e.pop(),t.pop(),t.forEach(o=>o.pop()),i.forEach(o=>o.pop());const s=Se(t,e,i,r,n);return s.push(0),s}function ze(t){const e=new N;let i=0;for(const r of t)for(const n of r)e.set(n.id,i++);return e}function je(t,e,i){const r=1+Math.max(...e.values()),n=[],s=[];for(const l of t){let[d,...u]=l;for(const c of u){const v=e.getThrow(d.id),p=e.getThrow(c.id),m=new Array(r).fill(0);m[v]=1,m[p]=-1,n.push(m),s.push(-(i(d)[0]+i(c)[0])/2),d=c}}const o=new Array(r).fill(0);return[new Array(r).fill(null).map(()=>new Array(r).fill(0)),o,n,s]}function $t(t,e,i,r){t[i][i]+=r,t[i][e]-=r,t[e][i]-=r,t[e][e]+=r}function Pe(t,e,i,r,n){t[r][r]+=n,t[r][i]-=2*n,t[r][e]+=n,t[i][r]-=2*n,t[i][i]+=4*n,t[i][e]-=2*n,t[e][r]+=n,t[e][i]-=2*n,t[e][e]+=n}function Ne(t,e,i,r){let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;for(const o of t){const a=o[0],l=o[o.length-1];n=Math.min(n,r[i.getThrow(a.id)]-e(a)[0]/2),s=Math.max(s,r[i.getThrow(l.id)]+e(l)[0]/2)}for(const o of t)for(const a of o)a.x=r[i.getThrow(a.id)]-n;return s-n}class Y extends Wt{constructor(e){super(e,void 0)}}function Fe(t){const e=new N;for(const n of t.slice().reverse())for(const s of n){for(const o of s.ichildren())e.delete(o.id);e.set(s.id,s)}const i=new P([...e.values()]).split(),r=new N;for(const[n,s]of i.entries())for(const o of s)r.set(o.id,n);return r}function Ae(t,e){const i=[];let r=[],n=new Set;for(const s of t){const o=new Set(s.map(a=>e.getThrow(a.id)));Dt(n,o)||i.push(r=[]),r.push(s),n=o}return i}function nt(t,e,i,r,n){function s(u,c,v){const p=ze(u),[m,f,b,x]=je(u,p,c);for(const C of u)for(const I of C){const g=p.getThrow(I.id),w=I instanceof Y?e:t;for(const B of I.ichildren()){const M=p.getThrow(B.id),E=B instanceof Y?e:t,V=B instanceof Y?r:i;$t(m,g,M,w+E);for(const j of B.ichildren()){const z=p.getThrow(j.id);Pe(m,g,M,z,V)}}}for(let[C,...I]of u)for(const g of I)v.getThrow(C.id)!==v.getThrow(g.id)&&$t(m,p.getThrow(C.id),p.getThrow(g.id),n),C=g;const y=$e(m,f,b,x);return Ne(u,c,p,y)}function o(u,c){if(t===0&&i===0)throw new Error("node vertical weight or node curve weight needs to be positive");if(e===0&&r===0)throw new Error("dummy vertical weight or dummy curve weight needs to be positive");const v=Fe(u),p=Ae(u,v),m=p.map(b=>s(b,c,v)),f=Math.max(...m);if(f<=0)throw new Error("must assign nonzero width to at least one node");for(const[b,x]of p.entries()){const y=(f-m[b])/2;for(const C of x)for(const I of C)I.x=Ut(I.x)+y}return f}function a(u){if(u===void 0)return[t,e];const[c,v]=u;if(c<0||v<0)throw new Error(`weights must be non-negative, but were ${c} and ${v}`);return nt(c,v,i,r,n)}o.vertical=a;function l(u){if(u===void 0)return[i,r];const[c,v]=u;if(c<0||v<0)throw new Error(`weights must be non-negative, but were ${c} and ${v}`);return nt(t,e,c,v,n)}o.curve=l;function d(u){if(u===void 0)return n;if(u<=0)throw new Error(`weight must be positive, but was ${u}`);return nt(t,e,i,r,u)}return o.component=d,o}function Le(...t){if(t.length)throw new Error(`got arguments to quad(${t}), but constructor takes no aruguments.`);return nt(1,0,0,1,1)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function qe(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(i[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i}function Gt(t,e,i,r){this.feasible=i,this.evaluation=e,this.bounded=r,this._tableau=t}var xt=Gt;Gt.prototype.generateSolutionSet=function(){for(var t={},e=this._tableau,i=e.varIndexByRow,r=e.variablesPerIndex,n=e.matrix,s=e.rhsColumn,o=e.height-1,a=Math.round(1/e.precision),l=1;l<=o;l+=1){var d=i[l],u=r[d];if(!(u===void 0||u.isSlack===!0)){var c=n[l][s];t[u.id]=Math.round((Number.EPSILON+c)*a)/a}}return t};function ot(t,e,i,r,n){xt.call(this,t,e,i,r),this.iter=n}var Ue=ot;ot.prototype=Object.create(xt.prototype);ot.constructor=ot;function D(t){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.simplexIters=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=t||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}var O=D;D.prototype.solve=function(){return this.model.getNumberOfIntegerVariables()>0?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()};function vt(t,e){this.priority=t,this.reducedCosts=new Array(e);for(var i=0;i<e;i+=1)this.reducedCosts[i]=0}vt.prototype.copy=function(){var t=new vt(this.priority,this.reducedCosts.length);return t.reducedCosts=this.reducedCosts.slice(),t};D.prototype.setOptionalObjective=function(t,e,i){var r=this.objectivesByPriority[t];if(r===void 0){var n=Math.max(this.width,e+1);r=new vt(t,n),this.objectivesByPriority[t]=r,this.optionalObjectives.push(r),this.optionalObjectives.sort(function(s,o){return s.priority-o.priority})}r.reducedCosts[e]=i};D.prototype.initialize=function(t,e,i,r){this.variables=i,this.unrestrictedVars=r,this.width=t,this.height=e;for(var n=new Array(t),s=0;s<t;s++)n[s]=0;this.matrix=new Array(e);for(var o=0;o<e;o++)this.matrix[o]=n.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=t+e-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars};D.prototype._resetMatrix=function(){var t=this.model.variables,e=this.model.constraints,i=t.length,r=e.length,n,s,o=this.matrix[0],a=this.model.isMinimization===!0?-1:1;for(n=0;n<i;n+=1){var l=t[n],d=l.priority,u=a*l.cost;d===0?o[n+1]=u:this.setOptionalObjective(d,n+1,u),s=t[n].index,this.rowByVarIndex[s]=-1,this.colByVarIndex[s]=n+1,this.varIndexByCol[n+1]=s}for(var c=1,v=0;v<r;v+=1){var p=e[v],m=p.index;this.rowByVarIndex[m]=c,this.colByVarIndex[m]=-1,this.varIndexByRow[c]=m;var f,b,x,y=p.terms,C=y.length,I=this.matrix[c++];if(p.isUpperBound){for(f=0;f<C;f+=1)b=y[f],x=this.colByVarIndex[b.variable.index],I[x]=b.coefficient;I[0]=p.rhs}else{for(f=0;f<C;f+=1)b=y[f],x=this.colByVarIndex[b.variable.index],I[x]=-b.coefficient;I[0]=-p.rhs}}};D.prototype.setModel=function(t){this.model=t;var e=t.nVariables+1,i=t.nConstraints+1;return this.initialize(e,i,t.variables,t.unrestrictedVariables),this._resetMatrix(),this};D.prototype.getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t};D.prototype.density=function(){for(var t=0,e=this.matrix,i=0;i<this.height;i++)for(var r=e[i],n=0;n<this.width;n++)r[n]!==0&&(t+=1);return t/(this.height*this.width)};D.prototype.setEvaluation=function(){var t=Math.round(1/this.precision),e=this.matrix[this.costRowIndex][this.rhsColumn],i=Math.round((Number.EPSILON+e)*t)/t;this.evaluation=i,this.simplexIters===0&&(this.bestPossibleEval=i)};D.prototype.getSolution=function(){var t=this.model.isMinimization===!0?this.evaluation:-this.evaluation;return this.model.getNumberOfIntegerVariables()>0?new Ue(this,t,this.feasible,this.bounded,this.branchAndCutIterations):new xt(this,t,this.feasible,this.bounded)};O.prototype.simplex=function(){return this.bounded=!0,this.phase1(),this.feasible===!0&&this.phase2(),this};O.prototype.phase1=function(){for(var t=this.model.checkForCycles,e=[],i=this.matrix,r=this.rhsColumn,n=this.width-1,s=this.height-1,o,a=0;;){for(var l=0,d=-this.precision,u=1;u<=s;u++){o=this.unrestrictedVars[this.varIndexByRow[u]]===!0;var c=i[u][r];c<d&&(d=c,l=u)}if(l===0)return this.feasible=!0,a;for(var v=0,p=-1/0,m=i[0],f=i[l],b=1;b<=n;b++){var x=f[b];if(o=this.unrestrictedVars[this.varIndexByCol[b]]===!0,o||x<-this.precision){var y=-m[b]/x;p<y&&(p=y,v=b)}}if(v===0)return this.feasible=!1,a;if(t){e.push([this.varIndexByRow[l],this.varIndexByCol[v]]);var C=this.checkForCycles(e);if(C.length>0)return this.model.messages.push("Cycle in phase 1"),this.model.messages.push("Start :"+C[0]),this.model.messages.push("Length :"+C[1]),this.feasible=!1,a}this.pivot(l,v),a+=1}};O.prototype.phase2=function(){for(var t=this.model.checkForCycles,e=[],i=this.matrix,r=this.rhsColumn,n=this.width-1,s=this.height-1,o=this.precision,a=this.optionalObjectives.length,l=null,d=0,u,c;;){var v=i[this.costRowIndex];a>0&&(l=[]);for(var p=0,m=o,f=!1,b=1;b<=n;b++){if(u=v[b],c=this.unrestrictedVars[this.varIndexByCol[b]]===!0,a>0&&-o<u&&u<o){l.push(b);continue}if(c&&u<0){-u>m&&(m=-u,p=b,f=!0);continue}u>m&&(m=u,p=b,f=!1)}if(a>0)for(var x=0;p===0&&l.length>0&&x<a;){var y=[],C=this.optionalObjectives[x].reducedCosts;m=o;for(var I=0;I<l.length;I++){if(b=l[I],u=C[b],c=this.unrestrictedVars[this.varIndexByCol[b]]===!0,-o<u&&u<o){y.push(b);continue}if(c&&u<0){-u>m&&(m=-u,p=b,f=!0);continue}u>m&&(m=u,p=b,f=!1)}l=y,x+=1}if(p===0)return this.setEvaluation(),this.simplexIters+=1,d;var g=0,w=1/0;this.varIndexByRow;for(var B=1;B<=s;B++){var M=i[B],E=M[r],V=M[p];if(!(-o<V&&V<o)){if(V>0&&o>E&&E>-o){w=0,g=B;break}var j=f?-E/V:E/V;j>o&&w>j&&(w=j,g=B)}}if(w===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[p],d;if(t){e.push([this.varIndexByRow[g],this.varIndexByCol[p]]);var z=this.checkForCycles(e);if(z.length>0)return this.model.messages.push("Cycle in phase 2"),this.model.messages.push("Start :"+z[0]),this.model.messages.push("Length :"+z[1]),this.feasible=!1,d}this.pivot(g,p,!0),d+=1}};var ut=[];O.prototype.pivot=function(t,e){var i=this.matrix,r=i[t][e],n=this.height-1,s=this.width-1,o=this.varIndexByRow[t],a=this.varIndexByCol[e];this.varIndexByRow[t]=a,this.varIndexByCol[e]=o,this.rowByVarIndex[a]=t,this.rowByVarIndex[o]=-1,this.colByVarIndex[a]=-1,this.colByVarIndex[o]=e;for(var l=i[t],d=0,u=0;u<=s;u++)l[u]>=-1e-16&&l[u]<=1e-16?l[u]=0:(l[u]/=r,ut[d]=u,d+=1);l[e]=1/r;var c,v,p;this.precision;for(var m=0;m<=n;m++)if(m!==t&&!(i[m][e]>=-1e-16&&i[m][e]<=1e-16)){var f=i[m];if(c=f[e],c>=-1e-16&&c<=1e-16)c!==0&&(f[e]=0);else{for(v=0;v<d;v++)u=ut[v],p=l[u],p>=-1e-16&&p<=1e-16?p!==0&&(l[u]=0):f[u]=f[u]-c*p;f[e]=-c/r}}var b=this.optionalObjectives.length;if(b>0)for(var x=0;x<b;x+=1){var y=this.optionalObjectives[x].reducedCosts;if(c=y[e],c!==0){for(v=0;v<d;v++)u=ut[v],p=l[u],p!==0&&(y[u]=y[u]-c*p);y[e]=-c/r}}};O.prototype.checkForCycles=function(t){for(var e=0;e<t.length-1;e++)for(var i=e+1;i<t.length;i++){var r=t[e],n=t[i];if(r[0]===n[0]&&r[1]===n[1]){if(i-e>t.length-i)break;for(var s=!0,o=1;o<i-e;o++){var a=t[e+o],l=t[i+o];if(a[0]!==l[0]||a[1]!==l[1]){s=!1;break}}if(s)return[e,i-e]}}return[]};function mt(t,e,i,r){this.id=t,this.cost=e,this.index=i,this.value=0,this.priority=r}function Jt(t,e,i,r){mt.call(this,t,e,i,r)}Jt.prototype.isInteger=!0;function yt(t,e){mt.call(this,t,0,e,0)}yt.prototype.isSlack=!0;function Zt(t,e){this.variable=t,this.coefficient=e}function Yt(t,e,i){return i===0||i==="required"?null:(e=e||1,i=i||1,t.isMinimization===!1&&(e=-e),t.addVariable(e,"r"+t.relaxationIndex++,!1,!1,i))}function X(t,e,i,r){this.slack=new yt("s"+i,i),this.index=i,this.model=r,this.rhs=t,this.isUpperBound=e,this.terms=[],this.termsByVarIndex={},this.relaxation=null}X.prototype.addTerm=function(t,e){var i=e.index,r=this.termsByVarIndex[i];if(r===void 0)r=new Zt(e,t),this.termsByVarIndex[i]=r,this.terms.push(r),this.isUpperBound===!0&&(t=-t),this.model.updateConstraintCoefficient(this,e,t);else{var n=r.coefficient+t;this.setVariableCoefficient(n,e)}return this};X.prototype.removeTerm=function(t){return this};X.prototype.setRightHandSide=function(t){if(t!==this.rhs){var e=t-this.rhs;this.isUpperBound===!0&&(e=-e),this.rhs=t,this.model.updateRightHandSide(this,e)}return this};X.prototype.setVariableCoefficient=function(t,e){var i=e.index;if(i===-1){console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.");return}var r=this.termsByVarIndex[i];if(r===void 0)this.addTerm(t,e);else if(t!==r.coefficient){var n=t-r.coefficient;this.isUpperBound===!0&&(n=-n),r.coefficient=t,this.model.updateConstraintCoefficient(this,e,n)}return this};X.prototype.relax=function(t,e){this.relaxation=Yt(this.model,t,e),this._relax(this.relaxation)};X.prototype._relax=function(t){t!==null&&(this.isUpperBound?this.setVariableCoefficient(-1,t):this.setVariableCoefficient(1,t))};function K(t,e){this.upperBound=t,this.lowerBound=e,this.model=t.model,this.rhs=t.rhs,this.relaxation=null}K.prototype.isEquality=!0;K.prototype.addTerm=function(t,e){return this.upperBound.addTerm(t,e),this.lowerBound.addTerm(t,e),this};K.prototype.removeTerm=function(t){return this.upperBound.removeTerm(t),this.lowerBound.removeTerm(t),this};K.prototype.setRightHandSide=function(t){this.upperBound.setRightHandSide(t),this.lowerBound.setRightHandSide(t),this.rhs=t};K.prototype.relax=function(t,e){this.relaxation=Yt(this.model,t,e),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)};var W={Constraint:X,Variable:mt,IntegerVariable:Jt,SlackVariable:yt,Equality:K,Term:Zt},gt=W.SlackVariable;O.prototype.addCutConstraints=function(t){for(var e=t.length,i=this.height,r=i+e,n=i;n<r;n+=1)this.matrix[n]===void 0&&(this.matrix[n]=this.matrix[n-1].slice());this.height=r,this.nVars=this.width+this.height-2;for(var s,o=this.width-1,a=0;a<e;a+=1){var l=t[a],d=i+a,u=l.type==="min"?-1:1,c=l.varIndex,v=this.rowByVarIndex[c],p=this.matrix[d];if(v===-1){for(p[this.rhsColumn]=u*l.value,s=1;s<=o;s+=1)p[s]=0;p[this.colByVarIndex[c]]=u}else{var m=this.matrix[v],f=m[this.rhsColumn];for(p[this.rhsColumn]=u*(l.value-f),s=1;s<=o;s+=1)p[s]=-u*m[s]}var b=this.getNewElementIndex();this.varIndexByRow[d]=b,this.rowByVarIndex[b]=d,this.colByVarIndex[b]=-1,this.variablesPerIndex[b]=new gt("s"+b,b),this.nVars+=1}};O.prototype._addLowerBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;this.model;var e=this.matrix,i=this.variablesPerIndex[this.varIndexByRow[t]];if(!i.isInteger)return!1;var r=e[t][this.rhsColumn],n=r-Math.floor(r);if(n<this.precision||1-this.precision<n)return!1;var s=this.height;e[s]=e[s-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[s]=o,this.rowByVarIndex[o]=s,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new gt("s"+o,o),e[s][this.rhsColumn]=Math.floor(r);for(var a=1;a<this.varIndexByCol.length;a+=1){var l=this.variablesPerIndex[this.varIndexByCol[a]];if(!l.isInteger)e[s][a]=Math.min(0,e[t][a]/(1-n));else{var d=e[t][a],u=Math.floor(d)+Math.max(0,d-Math.floor(d)-n)/(1-n);e[s][a]=u}}for(var c=0;c<this.width;c+=1)e[s][c]-=e[t][c];return!0};O.prototype._addUpperBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;this.model;var e=this.matrix,i=this.variablesPerIndex[this.varIndexByRow[t]];if(!i.isInteger)return!1;var r=e[t][this.rhsColumn],n=r-Math.floor(r);if(n<this.precision||1-this.precision<n)return!1;var s=this.height;e[s]=e[s-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[s]=o,this.rowByVarIndex[o]=s,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new gt("s"+o,o),e[s][this.rhsColumn]=-n;for(var a=1;a<this.varIndexByCol.length;a+=1){var l=this.variablesPerIndex[this.varIndexByCol[a]],d=e[t][a],u=d-Math.floor(d);l.isInteger?u<=n?e[s][a]=-u:e[s][a]=-(1-u)*n/u:d>=0?e[s][a]=-d:e[s][a]=d*n/(1-n)}return!0};O.prototype.applyMIRCuts=function(){};O.prototype._putInBase=function(t){var e=this.rowByVarIndex[t];if(e===-1){for(var i=this.colByVarIndex[t],r=1;r<this.height;r+=1){var n=this.matrix[r][i];if(n<-this.precision||this.precision<n){e=r;break}}this.pivot(e,i)}return e};O.prototype._takeOutOfBase=function(t){var e=this.colByVarIndex[t];if(e===-1){for(var i=this.rowByVarIndex[t],r=this.matrix[i],n=1;n<this.height;n+=1){var s=r[n];if(s<-this.precision||this.precision<s){e=n;break}}this.pivot(i,e)}return e};O.prototype.updateVariableValues=function(){for(var t=this.variables.length,e=Math.round(1/this.precision),i=0;i<t;i+=1){var r=this.variables[i],n=r.index,s=this.rowByVarIndex[n];if(s===-1)r.value=0;else{var o=this.matrix[s][this.rhsColumn];r.value=Math.round((o+Number.EPSILON)*e)/e}}};O.prototype.updateRightHandSide=function(t,e){var i=this.height-1,r=this.rowByVarIndex[t.index];if(r===-1){for(var n=this.colByVarIndex[t.index],s=0;s<=i;s+=1){var o=this.matrix[s];o[this.rhsColumn]-=e*o[n]}var a=this.optionalObjectives.length;if(a>0)for(var l=0;l<a;l+=1){var d=this.optionalObjectives[l].reducedCosts;d[this.rhsColumn]-=e*d[n]}}else this.matrix[r][this.rhsColumn]-=e};O.prototype.updateConstraintCoefficient=function(t,e,i){if(t.index===e.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var r=this._putInBase(t.index),n=this.colByVarIndex[e.index];if(n===-1)for(var s=this.rowByVarIndex[e.index],o=0;o<this.width;o+=1)this.matrix[r][o]+=i*this.matrix[s][o];else this.matrix[r][n]-=i};O.prototype.updateCost=function(t,e){var i=t.index,r=this.width-1,n=this.colByVarIndex[i];if(n===-1){var s=this.matrix[this.rowByVarIndex[i]],o;if(t.priority===0){var a=this.matrix[0];for(o=0;o<=r;o+=1)a[o]+=e*s[o]}else{var l=this.objectivesByPriority[t.priority].reducedCosts;for(o=0;o<=r;o+=1)l[o]+=e*s[o]}}else this.matrix[0][n]-=e};O.prototype.addConstraint=function(t){var e=t.isUpperBound?1:-1,i=this.height,r=this.matrix[i];r===void 0&&(r=this.matrix[0].slice(),this.matrix[i]=r);for(var n=this.width-1,s=0;s<=n;s+=1)r[s]=0;r[this.rhsColumn]=e*t.rhs;for(var o=t.terms,a=o.length,l=0;l<a;l+=1){var d=o[l],u=d.coefficient,c=d.variable.index,v=this.rowByVarIndex[c];if(v===-1)r[this.colByVarIndex[c]]+=e*u;else{var p=this.matrix[v];for(p[this.rhsColumn],s=0;s<=n;s+=1)r[s]-=e*u*p[s]}}var m=t.index;this.varIndexByRow[i]=m,this.rowByVarIndex[m]=i,this.colByVarIndex[m]=-1,this.height+=1};O.prototype.removeConstraint=function(t){var e=t.index,i=this.height-1,r=this._putInBase(e),n=this.matrix[i];this.matrix[i]=this.matrix[r],this.matrix[r]=n,this.varIndexByRow[r]=this.varIndexByRow[i],this.varIndexByRow[i]=-1,this.rowByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.slack.index=-1,this.height-=1};O.prototype.addVariable=function(t){var e=this.height-1,i=this.width,r=this.model.isMinimization===!0?-t.cost:t.cost,n=t.priority,s=this.optionalObjectives.length;if(s>0)for(var o=0;o<s;o+=1)this.optionalObjectives[o].reducedCosts[i]=0;n===0?this.matrix[0][i]=r:(this.setOptionalObjective(n,i,r),this.matrix[0][i]=0);for(var a=1;a<=e;a+=1)this.matrix[a][i]=0;var l=t.index;this.varIndexByCol[i]=l,this.rowByVarIndex[l]=-1,this.colByVarIndex[l]=i,this.width+=1};O.prototype.removeVariable=function(t){var e=t.index,i=this._takeOutOfBase(e),r=this.width-1;if(i!==r){for(var n=this.height-1,s=0;s<=n;s+=1){var o=this.matrix[s];o[i]=o[r]}var a=this.optionalObjectives.length;if(a>0)for(var l=0;l<a;l+=1){var d=this.optionalObjectives[l].reducedCosts;d[i]=d[r]}var u=this.varIndexByCol[r];this.varIndexByCol[i]=u,this.colByVarIndex[u]=i}this.varIndexByCol[r]=-1,this.colByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.index=-1,this.width-=1};O.prototype.log=function(t,e){console.log("****",t,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var i=5,r="",n=[" "],s,o,a,l,d,u,c,v,p,m,f;for(o=1;o<this.width;o+=1)d=this.varIndexByCol[o],l=this.variablesPerIndex[d],l===void 0?u="c"+d:u=l.id,c=u.length,v=" ",p="	",c>5?v+=" ":p+="	",n[o]=v,r+=p+u;console.log(r);var b,x=this.matrix[this.costRowIndex],y="	";for(s=1;s<this.width;s+=1)b="	",y+=b,y+=n[s],y+=x[s].toFixed(i);for(b="	",y+=b+n[0]+x[0].toFixed(i),console.log(y+"	Z"),a=1;a<this.height;a+=1){for(m=this.matrix[a],f="	",o=1;o<this.width;o+=1)b="	",f+=b+n[o]+m[o].toFixed(i);b="	",f+=b+n[0]+m[0].toFixed(i),d=this.varIndexByRow[a],l=this.variablesPerIndex[d],l===void 0?u="c"+d:u=l.id,console.log(f+"	"+u)}console.log("");var C=this.optionalObjectives.length;if(C>0){console.log("    Optional objectives:");for(var I=0;I<C;I+=1){var g=this.optionalObjectives[I].reducedCosts,w="";for(s=1;s<this.width;s+=1)b=g[s]<0?"":" ",w+=b,w+=n[s],w+=g[s].toFixed(i);b=g[0]<0?"":" ",w+=b+n[0]+g[0].toFixed(i),console.log(w+" z"+I)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this};O.prototype.copy=function(){var t=new O(this.precision);t.width=this.width,t.height=this.height,t.nVars=this.nVars,t.model=this.model,t.variables=this.variables,t.variablesPerIndex=this.variablesPerIndex,t.unrestrictedVars=this.unrestrictedVars,t.lastElementIndex=this.lastElementIndex,t.varIndexByRow=this.varIndexByRow.slice(),t.varIndexByCol=this.varIndexByCol.slice(),t.rowByVarIndex=this.rowByVarIndex.slice(),t.colByVarIndex=this.colByVarIndex.slice(),t.availableIndexes=this.availableIndexes.slice();for(var e=[],i=0;i<this.optionalObjectives.length;i++)e[i]=this.optionalObjectives[i].copy();t.optionalObjectives=e;for(var r=this.matrix,n=new Array(this.height),s=0;s<this.height;s++)n[s]=r[s].slice();return t.matrix=n,t};O.prototype.save=function(){this.savedState=this.copy()};O.prototype.restore=function(){if(this.savedState!==null){var t=this.savedState,e=t.matrix;this.nVars=t.nVars,this.model=t.model,this.variables=t.variables,this.variablesPerIndex=t.variablesPerIndex,this.unrestrictedVars=t.unrestrictedVars,this.lastElementIndex=t.lastElementIndex,this.width=t.width,this.height=t.height;var i,r;for(i=0;i<this.height;i+=1){var n=e[i],s=this.matrix[i];for(r=0;r<this.width;r+=1)s[r]=n[r]}var o=t.varIndexByRow;for(r=0;r<this.height;r+=1)this.varIndexByRow[r]=o[r];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var a=t.varIndexByCol;for(i=0;i<this.width;i+=1)this.varIndexByCol[i]=a[i];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var l=t.rowByVarIndex,d=t.colByVarIndex,u=0;u<this.nVars;u+=1)this.rowByVarIndex[u]=l[u],this.colByVarIndex[u]=d[u];if(t.optionalObjectives.length>0&&this.optionalObjectives.length>0){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var c=0;c<t.optionalObjectives.length;c++){var v=t.optionalObjectives[c].copy();this.optionalObjectives[c]=v,this.optionalObjectivePerPriority[v.priority]=v}}}};function Xt(t,e){this.index=t,this.value=e}O.prototype.getMostFractionalVar=function(){for(var t=0,e=null,i=null,r=this.model.integerVariables,n=r.length,s=0;s<n;s++){var o=r[s].index,a=this.rowByVarIndex[o];if(a!==-1){var l=this.matrix[a][this.rhsColumn],d=Math.abs(l-Math.round(l));t<d&&(t=d,e=o,i=l)}}return new Xt(e,i)};O.prototype.getFractionalVarWithLowestCost=function(){for(var t=1/0,e=null,i=null,r=this.model.integerVariables,n=r.length,s=0;s<n;s++){var o=r[s],a=o.index,l=this.rowByVarIndex[a];if(l!==-1){var d=this.matrix[l][this.rhsColumn];if(Math.abs(d-Math.round(d))>this.precision){var u=o.cost;t>u&&(t=u,e=a,i=d)}}}return new Xt(e,i)};O.prototype.countIntegerValues=function(){for(var t=0,e=1;e<this.height;e+=1)if(this.variablesPerIndex[this.varIndexByRow[e]].isInteger){var i=this.matrix[e][this.rhsColumn];i=i-Math.floor(i),i<this.precision&&-i<this.precision&&(t+=1)}return t};O.prototype.isIntegral=function(){for(var t=this.model.integerVariables,e=t.length,i=0;i<e;i++){var r=this.rowByVarIndex[t[i].index];if(r!==-1){var n=this.matrix[r][this.rhsColumn];if(Math.abs(n-Math.round(n))>this.precision)return!1}}return!0};O.prototype.computeFractionalVolume=function(t){for(var e=-1,i=1;i<this.height;i+=1)if(this.variablesPerIndex[this.varIndexByRow[i]].isInteger){var r=this.matrix[i][this.rhsColumn];r=Math.abs(r);var n=Math.min(r-Math.floor(r),Math.floor(r+1));if(n<this.precision){if(!t)return 0}else e===-1?e=r:e*=r}return e===-1?0:e};var De=O;function zt(t,e,i){this.type=t,this.varIndex=e,this.value=i}function ct(t,e){this.relaxedEvaluation=t,this.cuts=e}function We(t,e){return e.relaxedEvaluation-t.relaxedEvaluation}O.prototype.applyCuts=function(t){if(this.restore(),this.addCutConstraints(t),this.simplex(),this.model.useMIRCuts)for(var e=!0;e;){var i=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex();var r=this.computeFractionalVolume(!0);r>=.9*i&&(e=!1)}};O.prototype.branchAndCut=function(){var t=[],e=0,i=this.model.tolerance,r=!0,n=1e99;this.model.timeout&&(n=Date.now()+this.model.timeout);for(var s=1/0,o=null,a=[],l=0;l<this.optionalObjectives.length;l+=1)a.push(1/0);var d=new ct(-1/0,[]),u;for(t.push(d);t.length>0&&r===!0&&Date.now()<n;)if(this.model.isMinimization?u=this.bestPossibleEval*(1+i):u=this.bestPossibleEval*(1-i),i>0&&s<u&&(r=!1),d=t.pop(),!(d.relaxedEvaluation>s)){var c=d.cuts;if(this.applyCuts(c),e++,this.feasible!==!1){var v=this.evaluation;if(!(v>s)){if(v===s){for(var p=!0,m=0;m<this.optionalObjectives.length&&!(this.optionalObjectives[m].reducedCosts[0]>a[m]);m+=1)if(this.optionalObjectives[m].reducedCosts[0]<a[m]){p=!1;break}if(p)continue}if(this.isIntegral()===!0){if(this.__isIntegral=!0,e===1){this.branchAndCutIterations=e;return}o=d,s=v;for(var f=0;f<this.optionalObjectives.length;f+=1)a[f]=this.optionalObjectives[f].reducedCosts[0]}else{e===1&&this.save();for(var b=this.getMostFractionalVar(),x=b.index,y=[],C=[],I=c.length,g=0;g<I;g+=1){var w=c[g];w.varIndex===x?w.type==="min"?C.push(w):y.push(w):(y.push(w),C.push(w))}var B=Math.ceil(b.value),M=Math.floor(b.value),E=new zt("min",x,B);y.push(E);var V=new zt("max",x,M);C.push(V),t.push(new ct(v,y)),t.push(new ct(v,C)),t.sort(We)}}}}o!==null&&this.applyCuts(o.cuts),this.branchAndCutIterations=e};var He={},at=W.Constraint,Kt=W.Equality,Ge=W.Variable,Je=W.IntegerVariable;function R(t,e){this.tableau=new O(t),this.name=e,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!1,this.checkForCycles=!0,this.messages=[]}var dt=R;R.prototype.minimize=function(){return this.isMinimization=!0,this};R.prototype.maximize=function(){return this.isMinimization=!1,this};R.prototype._getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t};R.prototype._addConstraint=function(t){var e=t.slack;this.tableau.variablesPerIndex[e.index]=e,this.constraints.push(t),this.nConstraints+=1,this.tableauInitialized===!0&&this.tableau.addConstraint(t)};R.prototype.smallerThan=function(t){var e=new at(t,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e};R.prototype.greaterThan=function(t){var e=new at(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e};R.prototype.equal=function(t){var e=new at(t,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(e);var i=new at(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(i),new Kt(e,i)};R.prototype.addVariable=function(t,e,i,r,n){if(typeof n=="string")switch(n){case"required":n=0;break;case"strong":n=1;break;case"medium":n=2;break;case"weak":n=3;break;default:n=0;break}var s=this.tableau.getNewElementIndex();e==null&&(e="v"+s),t==null&&(t=0),n==null&&(n=0);var o;return i?(o=new Je(e,t,s,n),this.integerVariables.push(o)):o=new Ge(e,t,s,n),this.variables.push(o),this.tableau.variablesPerIndex[s]=o,r&&(this.unrestrictedVariables[s]=!0),this.nVariables+=1,this.tableauInitialized===!0&&this.tableau.addVariable(o),o};R.prototype._removeConstraint=function(t){var e=this.constraints.indexOf(t);if(e===-1){console.warn("[Model.removeConstraint] Constraint not present in model");return}this.constraints.splice(e,1),this.nConstraints-=1,this.tableauInitialized===!0&&this.tableau.removeConstraint(t),t.relaxation&&this.removeVariable(t.relaxation)};R.prototype.removeConstraint=function(t){return t.isEquality?(this._removeConstraint(t.upperBound),this._removeConstraint(t.lowerBound)):this._removeConstraint(t),this};R.prototype.removeVariable=function(t){var e=this.variables.indexOf(t);if(e===-1){console.warn("[Model.removeVariable] Variable not present in model");return}return this.variables.splice(e,1),this.tableauInitialized===!0&&this.tableau.removeVariable(t),this};R.prototype.updateRightHandSide=function(t,e){return this.tableauInitialized===!0&&this.tableau.updateRightHandSide(t,e),this};R.prototype.updateConstraintCoefficient=function(t,e,i){return this.tableauInitialized===!0&&this.tableau.updateConstraintCoefficient(t,e,i),this};R.prototype.setCost=function(t,e){var i=t-e.cost;return this.isMinimization===!1&&(i=-i),e.cost=t,this.tableau.updateCost(e,i),this};R.prototype.loadJson=function(t){this.isMinimization=t.opType!=="max";for(var e=t.variables,i=t.constraints,r={},n={},s=Object.keys(i),o=s.length,a=0;a<o;a+=1){var l=s[a],d=i[l],u=d.equal,c=d.weight,v=d.priority,p=c!==void 0||v!==void 0,m,f;if(u===void 0){var b=d.min;b!==void 0&&(m=this.greaterThan(b),r[l]=m,p&&m.relax(c,v));var x=d.max;x!==void 0&&(f=this.smallerThan(x),n[l]=f,p&&f.relax(c,v))}else{m=this.greaterThan(u),r[l]=m,f=this.smallerThan(u),n[l]=f;var y=new Kt(m,f);p&&y.relax(c,v)}}var C=Object.keys(e),I=C.length;this.tolerance=t.tolerance||0,t.timeout&&(this.timeout=t.timeout),t.options&&(t.options.timeout&&(this.timeout=t.options.timeout),this.tolerance===0&&(this.tolerance=t.options.tolerance||0),t.options.useMIRCuts&&(this.useMIRCuts=t.options.useMIRCuts),typeof t.options.exitOnCycles=="undefined"?this.checkForCycles=!0:this.checkForCycles=t.options.exitOnCycles);for(var g=t.ints||{},w=t.binaries||{},B=t.unrestricted||{},M=t.optimize,E=0;E<I;E+=1){var V=C[E],j=e[V],z=j[M]||0,q=!!w[V],F=!!g[V]||q,H=!!B[V],T=this.addVariable(z,V,F,H);q&&this.smallerThan(1).addTerm(1,T);var k=Object.keys(j);for(a=0;a<k.length;a+=1){var A=k[a];if(A!==M){var L=j[A],S=r[A];S!==void 0&&S.addTerm(L,T);var J=n[A];J!==void 0&&J.addTerm(L,T)}}}return this};R.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length};R.prototype.solve=function(){return this.tableauInitialized===!1&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()};R.prototype.isFeasible=function(){return this.tableau.feasible};R.prototype.save=function(){return this.tableau.save()};R.prototype.restore=function(){return this.tableau.restore()};R.prototype.activateMIRCuts=function(t){this.useMIRCuts=t};R.prototype.debug=function(t){this.checkForCycles=t};R.prototype.log=function(t){return this.tableau.log(t)};var Ze=function(t){var e,i,r;if(typeof t.optimize=="string")if(t.constraints[t.optimize]){e=Math.random();for(i in t.variables)t.variables[i][t.optimize]&&(t.variables[i][e]=t.variables[i][t.optimize]);return t.constraints[e]=t.constraints[t.optimize],delete t.constraints[t.optimize],t}else return t;else{for(r in t.optimize)if(t.constraints[r])if(t.constraints[r]==="equal")delete t.optimize[r];else{e=Math.random();for(i in t.variables)t.variables[i][r]&&(t.variables[i][e]=t.variables[i][r]);t.constraints[e]=t.constraints[r],delete t.constraints[r]}return t}},jt={CleanObjectiveAttributes:Ze};function Ye(t){var e={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_bin:/^(?!\/\*)\W{0,}bin/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,parse_bin:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},i={opType:"",optimize:"_obj",constraints:{},variables:{}},r={">=":"min","<=":"max","=":"equal"},n="",s=null,o="",a="",l="",d=0;typeof t=="string"&&(t=t.split(`
`));for(var u=0;u<t.length;u++)if(l="__"+u,n=t[u],s=null,e.is_objective.test(n))i.opType=n.match(/(max|min)/gi)[0],s=n.match(e.parse_lhs).map(function(p){return p.replace(/\s+/,"")}).slice(1),s.forEach(function(p){o=p.match(e.get_num),o===null?p.substr(0,1)==="-"?o=-1:o=1:o=o[0],o=parseFloat(o),a=p.match(e.get_word)[0].replace(/\;$/,""),i.variables[a]=i.variables[a]||{},i.variables[a]._obj=o});else if(e.is_int.test(n))s=n.match(e.parse_int).slice(1),i.ints=i.ints||{},s.forEach(function(p){p=p.replace(";",""),i.ints[p]=1});else if(e.is_bin.test(n))s=n.match(e.parse_bin).slice(1),i.binaries=i.binaries||{},s.forEach(function(p){p=p.replace(";",""),i.binaries[p]=1});else if(e.is_constraint.test(n)){var c=n.indexOf(":"),v=c===-1?n:n.slice(c+1);s=v.match(e.parse_lhs).map(function(p){return p.replace(/\s+/,"")}),s.forEach(function(p){o=p.match(e.get_num),o===null?p.substr(0,1)==="-"?o=-1:o=1:o=o[0],o=parseFloat(o),a=p.match(e.get_word)[0],i.variables[a]=i.variables[a]||{},i.variables[a][l]=o}),d=parseFloat(n.match(e.parse_rhs)[0]),n=r[n.match(e.parse_dir)[0]],i.constraints[l]=i.constraints[l]||{},i.constraints[l][n]=d}else e.is_unrestricted.test(n)&&(s=n.match(e.parse_int).slice(1),i.unrestricted=i.unrestricted||{},s.forEach(function(p){p=p.replace(";",""),i.unrestricted[p]=1}));return i}function Xe(t){if(!t)throw new Error("Solver requires a model to operate on");var e="",i={max:"<=",min:">=",equal:"="},r=new RegExp("[^A-Za-z0-9_[{}/.&#$%~'@^]","gi");if(t.opType){e+=t.opType+":";for(var n in t.variables)t.variables[n][n]=t.variables[n][n]?t.variables[n][n]:1,t.variables[n][t.optimize]&&(e+=" "+t.variables[n][t.optimize]+" "+n.replace(r,"_"))}else e+="max:";e+=`;

`;for(var s in t.constraints)for(var o in t.constraints[s])if(typeof i[o]!="undefined"){for(var a in t.variables)typeof t.variables[a][s]!="undefined"&&(e+=" "+t.variables[a][s]+" "+a.replace(r,"_"));e+=" "+i[o]+" "+t.constraints[s][o],e+=`;
`}if(t.ints){e+=`

`;for(var l in t.ints)e+="int "+l.replace(r,"_")+`;
`}if(t.unrestricted){e+=`

`;for(var d in t.unrestricted)e+="unrestricted "+d.replace(r,"_")+`;
`}return e}var wt=function(t){return t.length?Ye(t):Xe(t)},Ke={},ke=Object.freeze({__proto__:null,default:Ke});function Qe(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach(function(i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}),e}var Pt=Qe(ke),ti=wt;function Nt(t){return t=t.replace("\\r\\n",`\r
`),t=t.split(`\r
`),t=t.filter(function(e){var i;return i=new RegExp(" 0$","gi"),!(i.test(e)===!0||(i=new RegExp("\\d$","gi"),i.test(e)===!1))}).map(function(e){return e.split(/\:{0,1} +(?=\d)/)}).reduce(function(e,i,r){return e[i[0]]=i[1],e},{}),t}var ei=function(t){return new Promise(function(e,i){typeof window!="undefined"&&i("Function Not Available in Browser");var r=wt(t);t.external||i("Data for this function must be contained in the 'external' attribute. Not seeing anything there."),t.external.binPath||i("No Executable | Binary path provided in arguments as 'binPath'"),t.external.args||i("No arguments array for cli | bash provided on 'args' attribute"),t.external.tempName||i("No 'tempName' given. This is necessary to produce a staging file for the solver to operate on");var n=Pt;n.writeFile(t.external.tempName,r,function(s,o){if(s)i(s);else{var a=Pt.execFile;t.external.args.push(t.external.tempName),a(t.external.binPath,t.external.args,function(l,d){if(l)if(l.code===1)e(Nt(d));else{var u={"-2":"Out of Memory","1":"SUBOPTIMAL","2":"INFEASIBLE","3":"UNBOUNDED","4":"DEGENERATE","5":"NUMFAILURE","6":"USER-ABORT","7":"TIMEOUT","9":"PRESOLVED","25":"ACCURACY ERROR","255":"FILE-ERROR"},c={code:l.code,meaning:u[l.code],data:d};i(c)}else e(Nt(d))})}})})},ii={reformat:ti,solve:ei},et={lpsolve:ii},Ft=function(t,e){var i=e.optimize,r=JSON.parse(JSON.stringify(e.optimize)),n=Object.keys(e.optimize),s,o=0,a={},l="",d={},u=[],c,v,p,m;for(delete e.optimize,c=0;c<n.length;c++)r[n[c]]=0;for(c=0;c<n.length;c++){e.optimize=n[c],e.opType=i[n[c]],s=t.Solve(e,void 0,void 0,!0);for(m in n)if(!e.variables[n[m]]){s[n[m]]=s[n[m]]?s[n[m]]:0;for(p in e.variables)e.variables[p][n[m]]&&s[p]&&(s[n[m]]+=s[p]*e.variables[p][n[m]])}for(l="base",v=0;v<n.length;v++)s[n[v]]?l+="-"+(s[n[v]]*1e3|0)/1e3:l+="-0";if(!a[l]){for(a[l]=1,o++,v=0;v<n.length;v++)s[n[v]]&&(r[n[v]]+=s[n[v]]);delete s.feasible,delete s.result,u.push(s)}}for(c=0;c<n.length;c++)e.constraints[n[c]]={equal:r[n[c]]/o};e.optimize="cheater-"+Math.random(),e.opType="max";for(c in e.variables)e.variables[c].cheater=1;for(c in u)for(p in u[c])d[p]=d[p]||{min:1e99,max:-1e99};for(c in d)for(p in u)u[p][c]?(u[p][c]>d[c].max&&(d[c].max=u[p][c]),u[p][c]<d[c].min&&(d[c].min=u[p][c])):(u[p][c]=0,d[c].min=0);return s=t.Solve(e,void 0,void 0,!0),{midpoint:s,vertices:u,ranges:d}},ri=W.Constraint,ni=W.Variable,si=W.Numeral,oi=W.Term,pt=function(){this.Model=dt,this.branchAndCut=He,this.Constraint=ri,this.Variable=ni,this.Numeral=si,this.Term=oi,this.Tableau=De,this.lastSolvedModel=null,this.External=et,this.Solve=function(t,e,i,r){if(r)for(var n in jt)t=jt[n](t);if(!t)throw new Error("Solver requires a model to operate on");if(typeof t.optimize=="object"&&Object.keys(t.optimize>1))return Ft(this,t);if(t.external){var s=Object.keys(et);if(s=JSON.stringify(s),!t.external.solver)throw new Error("The model you provided has an 'external' object that doesn't have a solver attribute. Use one of the following:"+s);if(!et[t.external.solver])throw new Error("No support (yet) for "+t.external.solver+". Please use one of these instead:"+s);return et[t.external.solver].solve(t)}else{t instanceof dt||(t=new dt(e).loadJson(t));var o=t.solve();if(this.lastSolvedModel=t,o.solutionSet=o.generateSolutionSet(),i)return o;var a={};return a.feasible=o.feasible,a.result=o.evaluation,a.bounded=o.bounded,o._tableau.__isIntegral&&(a.isIntegral=!0),Object.keys(o.solutionSet).forEach(function(l){o.solutionSet[l]!==0&&(a[l]=o.solutionSet[l])}),a}},this.ReformatLP=wt,this.MultiObjective=function(t){return Ft(this,t)}};typeof window=="object"?window.solver=new pt:typeof self=="object"&&(self.solver=new pt);var ai=new pt;function bt(t,e){const i=e?"":"\0",r=e?"rank: ":"\0",n=e?" -> ":"\0";function s(c){return`${i}${c.id}`}function o(c){return`${c.source.id}${n}${c.target.id}`}function a(c,v){return`${r}${c.id}${n}${v.id}`}function l(c){const v=Object.create(null),p=Object.create(null),m=Object.create(null),f=[];for(const g of c){const w=s(g);p[w]=1,v[w]={opt:g.children.length};const B=t(g);B!==void 0&&f.push([B,g])}for(const g of c.ilinks()){const w=v[s(g.source)],B=v[s(g.target)],M=o(g);m[M]={min:1},w[M]=-1,w.opt++,B[M]=1,B.opt--}let[b,...x]=f.sort(([g],[w])=>g-w);for(const g of x){const[w,B]=b,[M,E]=g,V=v[s(B)],j=v[s(E)],z=a(B,E);if(w<M)m[z]={min:1},V[z]=-1,j[z]=1;else{const q=a(E,B);m[z]={min:0},m[q]={min:0},V[z]=-1,V[q]=1,j[z]=1,j[q]=-1}b=g}const y=ai.Solve({optimize:"opt",opType:"max",constraints:m,variables:v,ints:p}),{feasible:C}=y,I=qe(y,["feasible"]);if(!C)throw f.length?new Error("could not find a feasbile simplex layout, check that rank accessors are not ill-defined"):new Error("could not find feasbile simplex layout, this should not happen");for(const g of c)g.layer=I[s(g)]||0}function d(c){return c===void 0?t:bt(c,e)}l.rank=d;function u(c){return c===void 0?e:bt(t,c)}return l.debug=u,l}function hi(){}function li(...t){if(t.length)throw new Error(`got arguments to simplex(${t}), but constructor takes no aruguments.`);return bt(hi,!1)}function fi(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function*ui(t,e){if(e===void 0)for(let i of t)i!=null&&(i=+i)>=i&&(yield i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(r=+r)>=r&&(yield r)}}function At(t,e){let i;if(e===void 0)for(const r of t)r!=null&&(i<r||i===void 0&&r>=r)&&(i=r);else{let r=-1;for(let n of t)(n=e(n,++r,t))!=null&&(i<n||i===void 0&&n>=n)&&(i=n)}return i}function Lt(t,e){let i;if(e===void 0)for(const r of t)r!=null&&(i>r||i===void 0&&r>=r)&&(i=r);else{let r=-1;for(let n of t)(n=e(n,++r,t))!=null&&(i>n||i===void 0&&n>=n)&&(i=n)}return i}function kt(t,e,i=0,r=t.length-1,n=fi){for(;r>i;){if(r-i>600){const l=r-i+1,d=e-i+1,u=Math.log(l),c=.5*Math.exp(2*u/3),v=.5*Math.sqrt(u*c*(l-c)/l)*(d-l/2<0?-1:1),p=Math.max(i,Math.floor(e-d*c/l+v)),m=Math.min(r,Math.floor(e+(l-d)*c/l+v));kt(t,e,p,m,n)}const s=t[e];let o=i,a=r;for(Q(t,i,e),n(t[r],s)>0&&Q(t,i,r);o<a;){for(Q(t,o,a),++o,--a;n(t[o],s)<0;)++o;for(;n(t[a],s)>0;)--a}n(t[i],s)===0?Q(t,i,a):(++a,Q(t,a,r)),a<=e&&(i=a+1),e<=a&&(r=a-1)}return t}function Q(t,e,i){const r=t[e];t[e]=t[i],t[i]=r}function ci(t,e,i){if(t=Float64Array.from(ui(t,i)),!!(r=t.length)){if((e=+e)<=0||r<2)return Lt(t);if(e>=1)return At(t);var r,n=(r-1)*e,s=Math.floor(n),o=At(kt(t,s).subarray(0,s+1)),a=Lt(t.subarray(s+1));return o+(a-o)*(n-s)}}function di(t,e){return ci(t,.5,e)}function vi(...t){if(t.length)throw new Error(`got arguments to median(${t}), but constructor takes no aruguments.`);function e(i,r){const n=new N;for(const[a,l]of i.entries())for(const d of l.ichildren())n.setIfAbsent(d.id,[]).push(a);const s=new N;let o=-1;for(const a of r){const l=di(n.getDefault(a.id,[]));l===void 0?(s.set(a.id,o),o=+!((o+1)/(i.length+1))*(i.length+1)-1):s.set(a.id,l)}r.sort((a,l)=>s.getThrow(a.id)-s.getThrow(l.id))}return e}function Qt(t){function e(r){r.slice(0,r.length-1).forEach((n,s)=>t(n,r[s+1]))}function i(r){return r===void 0?t:Qt(r)}return e.order=i,e}function pi(...t){if(t.length)throw new Error(`got arguments to twoLayer(${t}), but constructor takes no aruguments.`);return Qt(vi())}function bi(t){const e=new Map;function i(r){let n=e.get(r.id);if(n===void 0){n=t(r);const[s,o]=n;if(s<0||o<0)throw new Error(`all node sizes must be non-negative, but got width ${s} and height ${o} for node id: ${r.id}`);e.set(r.id,n)}return n}return i}function Z(t,e,i,r,n,s){function o(f){const b=[];for(const x of f.descendants()){const y=x.layer;(b[y]||(b[y]=[])).push(x),x.dataChildren=x.dataChildren.map(I=>{const g=I.child.layer;if(g<=y)throw new Error(`layering left child node "${I.child.id}" (${g}) with a greater or equal layer to parent node "${x.id}" (${y})`);let w=I.child;for(let B=g-1;B>y;B--){let M;s?M=`${x.id}->${I.child.id} (${B})`:M=`${x.id}\0${I.child.id}\0${B}`;const E=new Y(M);E.dataChildren.push(new it(w,void 0)),(b[B]||(b[B]=[])).push(E),w=E}return new it(w,I.data)})}return b}function a(f){for(const b of f)b instanceof Y||(b.dataChildren=b.dataChildren.map(x=>{let y=x.child;const C=[{x:b.x,y:b.y}];for(;y instanceof Y;)C.push({x:y.x,y:y.y}),[y]=y.ichildren();return C.push({x:y.x,y:y.y}),new it(y,x.data,C)}))}function l(f){t(f);for(const w of f){const B=w.layer;if(B===void 0)throw new Error(`layering did not assign layer to node '${w.id}'`);if(B<0)throw new Error(`layering assigned a negative layer (${B}) to node '${w.id}'`)}const b=o(f),x=bi(n);let y=0;for(const w of b){const B=Math.max(...w.map(M=>x(M)[1]));for(const M of w)M.y=y+B/2;y+=B}if(y<=0)throw new Error("at least one node must have positive height, but total height was zero");e(b);let C=i(b,x);for(const w of b)for(const B of w){if(B.x===void 0)throw new Error(`coord didn't assign an x to node '${B.id}'`);if(B.x<0||B.x>C)throw new Error(`coord assgined an x (${B.x}) outside of [0, ${C}]`)}const I=b;if(r!==null){const[w,B]=r;for(const M of I)for(const E of M)E.x*=w/C,E.y*=B/y;C=w,y=B}const g=f;return a(g),{dag:g,width:C,height:y}}function d(f){return f===void 0?t:Z(f,e,i,r,n,s)}l.layering=d;function u(f){return f===void 0?e:Z(t,f,i,r,n,s)}l.decross=u;function c(f){return f===void 0?i:Z(t,e,f,r,n,s)}l.coord=c;function v(f){return f!==void 0?Z(t,e,i,f,n,s):r}l.size=v;function p(f){return f!==void 0?Z(t,e,i,r,f,s):n}l.nodeSize=p;function m(f){return f===void 0?s:Z(t,e,i,r,n,f)}return l.debug=m,l}function xi(t){const e=+!(t instanceof Y);return[e,e]}function Ii(...t){if(t.length)throw new Error(`got arguments to sugiyama(${t}), but constructor takes no aruguments.`);return Z(li(),pi(),Le(),null,xi,!1)}function te(t){function e(n){const s=Math.max(...n.iroots().map(o=>o.value));for(const o of n)o.layer=s-o.value}function i(n){if(t)for(const s of n.depth())s.layer=s.value;else e(n.height())}function r(n){return n===void 0?t:te(n)}return i.topDown=r,i}function _i(...t){if(t.length)throw new Error(`got arguments to longestPath(${t}), but constructor takes no aruguments.`);return te(!0)}function Ci(...t){if(t.length)throw new Error(`got arguments to center(${t}), but constructor takes no aruguments.`);function e(i,r){const n=i.map(o=>{let a=0;for(const l of o){const d=r(l)[0];l.x=a+d/2,a+=d}return a}),s=Math.max(...n);if(s<=0)throw new Error("must assign nonzero width to at least one node");for(const[o,a]of i.entries()){const l=n[o],d=(s-l)/2;for(const u of a)u.x=Ut(u.x)+d}return s}return e}export{wi as a,Ci as c,_i as l,gi as m,Ii as s,pi as t,ue as w};
